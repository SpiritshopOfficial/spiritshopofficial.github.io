<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Polyrhythms by Spiritshop</title>
  
  <meta name="author" content="Spiritshop Official">
  <meta name="description" content="Polyrhytmic mixing tool">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" type="image/svg+xml" href="/polyrhythms/favicon.svg">
  <link rel="icon" type="image/png" href="/polyrhythms/favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/polyrhythms/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/polyrhythms/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/polyrhythms/favicon-16x16.png">
  <link rel="manifest" href="/polyrhythms/site.webmanifest">
  <link rel="shortcut icon" href="/polyrhythms/favicon.ico">
  <meta name="msapplication-TileColor" content="#222222">
  <meta name="msapplication-config" content="/polyrhythms/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Roboto+Condensed&display=swap" rel="stylesheet">

  <style>

html {
  color: #fff;
  font-family: "Inter", sans-serif;
  scroll-behavior: smooth;
  display: flex;
  justify-content: center;
}

body {
  margin: 0.6rem;
  background: #222;
  width: 100%;
  max-width: 24rem;
}

h1 {
  margin: 1.2rem 0 1.5rem;
}

h2 {
  margin: 1.8rem 0 1.5rem;
}

.form-group {
  position: relative;
}

input {
  width: 100%;
  box-sizing: border-box;
  font-family: "Inter", sans-serif;
  font-size: 1rem;
  text-align: center;
  line-height: 2.4rem;
  padding-right: 3.3rem;
  border: 2px solid #444;
  border-radius: .45rem;
  background: #111;
  color: #fff;
}

label {
  position: absolute;
  top: calc(50% - 0.5rem);
  right: calc(50% - 2.7rem);
  color: #fff;
  font-size: 1rem;
  line-height: 1rem;
}

.change-buttons {
 display: flex;
  margin: .3rem 0 1.5rem;
}

a {
  display: inline-block;
  color: #fff;
  text-align: center;
  font-size: 1rem;
  margin-right: .3rem;
  line-height: 2.4rem;
  background: #111;
  border-radius: .45rem;
  text-decoration: none;
  font-weight: 700;
}

a:last-child {
  margin-right: 0;
}

.button-3 {
  flex: 4;
}

.button-2 {
  flex:3;
}

.button-1 {
  flex: 2;
}

h2 {
  margin: 1.8rem 0 1.5rem;
}

#table {
  display: flex;
  flex-direction: column;
  margin: 1.5rem 0 1.2rem;
}

.row {
  display: flex;
  margin-bottom: .6rem;
}

.cell-1,
.cell-2 {
  line-height: 1rem;
}

.cell-1 {
  font-weight: 700;
  margin-right: 1.5rem;
  width: 2.7rem;
  font-size: 1.05rem;
}

.cell-2 {
  cursor: pointer;
}
    
  </style>
  
</head>
<body>
  
  <h1>Polyrhythms</h1>
  <div class="form-group">
    <label for="current-bpm">bpm</label>
    <input type="text" name="current-bpm" value="120.00" id="bpmInput" inputmode="decimal" pattern="[0-9]*" step="any"></input>
  </div>
  <div class="change-buttons">
    <a href="#" class="button-3" onclick="changeBpm(-10)" id="A-link">---</a>
    <a href="#" class="button-2" onclick="changeBpm(-1)" id="A-link">--</a>
    <a href="#" class="button-1" onclick="changeBpm(-0.1)" id="A-link">-</a>
    <a href="#" class="button-1" onclick="changeBpm(0.1)" id="A-link">+</a>
    <a href="#" class="button-2" onclick="changeBpm(1)" id="A-link">++</a>
    <a href="#" class="button-3" onclick="changeBpm(10)" id="A-link">+++</a>
  </div>

  <h2>Calculations</h2>
  <div id="table">
    <div class="row">
      <div class="cell-1">1/2</div>
      <div class="cell-2" id="result1">60 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">2/3</div>
      <div class="cell-2" id="result2">80 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">3/4</div>
      <div class="cell-2" id="result3">90 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">4/5</div>
      <div class="cell-2" id="result4">90 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">5/4</div>
      <div class="cell-2" id="result5">90 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">4/3</div>
      <div class="cell-2" id="result6">96 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">3/2</div>
      <div class="cell-2" id="result7">180 bpm</div>
    </div>
    <div class="row">
      <div class="cell-1">2</div>
      <div class="cell-2" id="result8">240 bpm</div>
    </div>
  </div>
  
<script>

  let currentBpm = 120.00;
  let isTyping = false;

  function changeBpm(value) {
    currentBpm += value;
    document.getElementById('bpmInput').value = currentBpm.toFixed(2);
    updateResults();
  }

  function updateResults() {
    const bpm1 = (currentBpm / 2).toFixed(2);
    const bpm2 = (currentBpm * 2 / 3).toFixed(2);
    const bpm3 = (currentBpm * 3 / 4).toFixed(2);
    const bpm4 = (currentBpm * 4 / 5).toFixed(2);
    const bpm5 = (currentBpm * 5 / 4).toFixed(2);
    const bpm6 = (currentBpm * 4 / 3).toFixed(2);
    const bpm7 = (currentBpm * 3 / 2).toFixed(2);
    const bpm8 = (currentBpm * 2).toFixed(2);

    document.getElementById('result1').innerText = bpm1 + " bpm";
    document.getElementById('result2').innerText = bpm2 + " bpm";
    document.getElementById('result3').innerText = bpm3 + " bpm";
    document.getElementById('result4').innerText = bpm4 + " bpm";
    document.getElementById('result5').innerText = bpm5 + " bpm";
    document.getElementById('result6').innerText = bpm6 + " bpm";
    document.getElementById('result7').innerText = bpm7 + " bpm";
    document.getElementById('result8').innerText = bpm8 + " bpm";

    // Add event listeners to results for inserting into input
    document.getElementById('result1').onclick = () => insertBpm(bpm1);
    document.getElementById('result2').onclick = () => insertBpm(bpm2);
    document.getElementById('result3').onclick = () => insertBpm(bpm3);
    document.getElementById('result4').onclick = () => insertBpm(bpm4);
    document.getElementById('result5').onclick = () => insertBpm(bpm5);
    document.getElementById('result6').onclick = () => insertBpm(bpm6);
    document.getElementById('result7').onclick = () => insertBpm(bpm7);
    document.getElementById('result8').onclick = () => insertBpm(bpm8);
  }

  function handleInput() {
    isTyping = true;
  }

  function handleBlur() {
    if (isTyping) {
      isTyping = false;
      let inputBpm = parseFloat(document.getElementById('bpmInput').value.replace(',', '.'));
      if (isNaN(inputBpm)) {
        inputBpm = currentBpm; // Use currentBpm if the input is not a valid number
      }
      currentBpm = inputBpm;
      document.getElementById('bpmInput').value = currentBpm.toFixed(2);
      updateResults();
    }
  }

  function handleKeyPress(event) {
    if (event.key === 'Enter') {
      inputField.blur();
    }
  }

  function insertBpm(value) {
    document.getElementById('bpmInput').value = value;
    currentBpm = parseFloat(value);
    updateResults(); // Update calculations when a result is clicked
  }

  // Add event listeners to the input field for input, blur, and keypress events
  const inputField = document.getElementById('bpmInput');
  inputField.addEventListener('input', handleInput);
  inputField.addEventListener('blur', handleBlur);
  inputField.addEventListener('keypress', handleKeyPress);

  // Add click event listener to clear the input field when tapped on mobile devices
  inputField.addEventListener('click', () => {
    inputField.value = '';
  });

  updateResults(); // Initial update

</script>
  
</body>
</html>
